(this["webpackJsonpmap-app"]=this["webpackJsonpmap-app"]||[]).push([[0],{202:function(e,t,n){e.exports={statisticAddon:"MeanPriceInFilterLocation_statisticAddon__ZZijL",textGreen:"MeanPriceInFilterLocation_textGreen__1TxZ3",textRed:"MeanPriceInFilterLocation_textRed__2oGI9"}},203:function(e,t,n){e.exports={container:"App_container__1MQN3",grid:"App_grid__3DnSg",leftPanel:"App_leftPanel__3Hl9k",rightPanel:"App_rightPanel__kN-EW",githubCorner:"App_githubCorner__3BLKB"}},331:function(e,t,n){e.exports={shake:"Navigation_shake__1loJY","bell-shake":"Navigation_bell-shake__28FvC",notificationLink:"Navigation_notificationLink__dwBb-"}},351:function(e,t,n){e.exports={container:"FilterToolbar_container__3xqZF",categoryDropdown:"FilterToolbar_categoryDropdown__2VBih"}},353:function(e,t,n){e.exports={container:"PropertyPriceChart_container__b6m2Q",tooltip:"PropertyPriceChart_tooltip__iGhsd"}},354:function(e,t,n){e.exports={content:"Home_content__sgIvw",highlightedText:"Home_highlightedText__3zLCN"}},462:function(e){e.exports=JSON.parse('{"name":"map-app","version":"0.2.0","homepage":"https://map.brokalys.com","private":true,"dependencies":{"@apollo/client":"^3.0.0-beta.45","@brokalys/location-json-schemas":"^1.2.0","@bugsnag/js":"^7.1.0","@bugsnag/plugin-react":"^7.1.0","@nivo/bar":"^0.67.0","@nivo/core":"^0.67.0","@nivo/line":"^0.67.0","@react-google-maps/api":"^2.1.1","apollo-link":"^1.2.14","apollo-link-debounce":"^2.1.0","apollo-link-rest":"^0.7.3","connected-react-router":"^6.9.1","graphql":"^15.0.0","graphql-anywhere":"^4.2.7","history":"^4.10.1","moment":"^2.25.3","prop-types":"^15.7.2","query-string":"^7.0.0","react":"^17.0.1","react-dom":"^17.0.1","react-error-boundary":"^3.0.0","react-github-corner":"^2.3.0","react-loading-skeleton":"^2.0.1","react-redux":"^7.2.3","react-router-dom":"^5.2.0","react-table":"^7.6.3","redux":"^4.0.5","redux-devtools-extension":"^2.13.9","redux-saga":"^1.1.3","reselect":"^4.0.0","semantic-ui-css":"^2.4.1","semantic-ui-react":"^2.0.1","transliteration":"^2.1.11"},"devDependencies":{"@testing-library/jest-dom":"^5.9.0","@testing-library/react":"^11.0.2","@testing-library/user-event":"^12.0.2","husky":"^4.2.5","lint-staged":"^10.2.2","node-sass":"^5.0.0","prettier":"^2.0.5","react-scripts":"4.0.3"},"scripts":{"postinstall":"node ./scripts/patch-react-spring.js","start":"react-scripts start","build":"react-scripts build","test":"react-scripts test","eject":"react-scripts eject"},"eslintConfig":{"extends":"react-app"},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]},"husky":{"hooks":{"pre-commit":"lint-staged"}},"lint-staged":{"src/**/*.{js,jsx,json,css,scss,md}":["prettier --write"]},"config":{"commitizen":{"path":"cz-emoji"},"cz-emoji":{"symbol":true}}}')},464:function(e,t,n){e.exports={container:"Footer_container__st7Zp"}},467:function(e,t,n){e.exports={loadingIndicator:"BuildingPolygons_loadingIndicator__12R8e"}},468:function(e,t,n){e.exports={container:"SplitPaneRight_container__x3kzx"}},481:function(e,t,n){e.exports={stats:"BuildingTable_stats__3-b6T"}},678:function(e,t,n){},679:function(e,t,n){"use strict";n.r(t);var r=n(96),a=n(0),c=n.n(a),i=n(62),o=n.n(i),s=n(23),l=n(54),u=n(24),d=n(457),j=n(460),b=n.n(j),p=n(461),h=n(462),g=new b.a(3e3),O=new l.HttpLink({uri:"https://api.brokalys.com"}),x=new p.RestLink({uri:"https://static-api.brokalys.com"}),m=Object(d.a)((function(e,t){var n=t.headers;return{headers:Object(u.a)(Object(u.a)({},n),{},{"x-api-key":"a5DYSaHzTd4Xe5pv9N7VX5Ew9fbiQ3kF3khhsnC3"})}})),f=new l.ApolloClient({cache:new l.InMemoryCache,link:l.ApolloLink.from([g,x,m,O]),version:h.version}),v=n(276),y=n(463),_=n.n(y),w=n(736),k=n(750),C=n(740),S=n(464),P=n.n(S),I=n(2);var F=function(){return Object(I.jsx)("div",{className:P.a.container,children:Object(I.jsxs)(C.a,{bulleted:!0,horizontal:!0,link:!0,children:[Object(I.jsx)(C.a.Item,{as:"a",href:"https://pinger.brokalys.com/#/terms-and-conditions",target:"_blank",children:"Terms & Conditions"}),Object(I.jsx)(C.a.Item,{as:"a",href:"https://pinger.brokalys.com/#/privacy-policy",target:"_blank",children:"Privacy Policy"})]})})},L=n(748),N=n(737),q=n(139),R=n(744);var M=function(){return Object(I.jsx)(R.a,{color:"red",content:"Support the project",icon:"heart",href:"https://www.buymeacoffee.com/matissjanis",target:"_blank"})},A=n(331),E=n.n(A);var B=function(){return Object(I.jsxs)(L.a,{secondary:!0,children:[Object(I.jsx)(L.a.Header,{children:Object(I.jsx)("img",{src:"https://brokalys.com/favicon.png",alt:"logo",height:"40px"})}),Object(I.jsx)(L.a.Item,{position:"right",children:Object(I.jsx)(N.a,{content:"Sign up for instant notifications about classifieds matching your parameters",inverted:!0,position:"bottom right",trigger:Object(I.jsx)("a",{href:"https://pinger.brokalys.com",target:"_blank",rel:"noopener noreferrer",className:E.a.notificationLink,"data-testid":"pinger-button",children:Object(I.jsx)(q.a,{name:"bell outline",className:E.a.shake})})})}),Object(I.jsx)(L.a.Item,{fitted:!0,children:Object(I.jsxs)(R.a,{primary:!0,animated:"vertical",onClick:function(){window.location.href="mailto:matiss@brokalys.com?subject=Feedback"},children:[Object(I.jsx)(R.a.Content,{visible:!0,children:"Give feedback"}),Object(I.jsx)(R.a.Content,{hidden:!0,children:Object(I.jsx)(q.a,{name:"mail"})})]})}),Object(I.jsx)(L.a.Item,{fitted:!0,children:Object(I.jsx)(M,{})})]})},H=n(22),T=n(154),D=56.94734440635773,z=24.105604143682786,G=13;function Y(){var e=Object(v.e)(),t=e.lat,n=void 0===t?D:t,r=e.lng,c=void 0===r?z:r,i=e.zoom,o=void 0===i?G:i;return Object(a.useMemo)((function(){return{lat:parseFloat(n),lng:parseFloat(c),zoom:parseInt(o,10)}}),[n,c,o])}var W,$="CLICK_ON_BUILDING",V="RETURN_TO_HOME_CLICKED",Q="MAP_BOUNDS_CHANGED",U="MAP_PROJECTION_CHANGED",Z="SET_SELECTED_NEIGHBORHOOD",K="SET_NEIGHBORHOOD_FILTERS",J=function(e){return{type:U,payload:e}},X=function(e){return{type:K,payload:e}},ee=n(749),te=n(746),ne=n(728),re=n(183),ae=Object(l.gql)(W||(W=Object(re.a)(["\n  query UseRegionBuildings($region: String!, $filter: PropertyFilter) {\n    bounds(bounds: $region) {\n      buildings {\n        id\n        bounds\n        properties(filter: $filter) {\n          results {\n            category\n            type\n            rent_type\n            price\n            calc_price_per_sqm\n            rooms\n            area\n            floor\n            published_at\n          }\n        }\n      }\n    }\n  }\n"])));function ce(e){var t,n=Object(l.useQuery)(ae,{variables:{region:e,filter:{category:{in:["apartment","house","office"]},type:{in:["sell","rent","auction"]},price:{gt:1}}},context:{debounceKey:"GET_BUILDINGS_AND_PROPERTIES"}}),r=n.loading,a=n.data;return{loading:r,data:(null===a||void 0===a||null===(t=a.bounds)||void 0===t?void 0:t.buildings)||[]}}var ie=n(90),oe=function(e){return e.map};var se=Object(ie.a)(oe,(function(e){return function(e){if(e.ne)return[[e.ne.lat,e.ne.lng].join(" "),[e.nw.lat,e.nw.lng].join(" "),[e.sw.lat,e.sw.lng].join(" "),[e.se.lat,e.se.lng].join(" "),[e.ne.lat,e.ne.lng].join(" ")].join(", ")}(e.bounds)})),le=(Object(ie.a)(oe,(function(e){return e.bounds})),n(172)),ue=n(184),de=function(e){return e.neighborhood},je=ue.riga.features.reduce((function(e,t){return Object(u.a)(Object(u.a)({},e),{},Object(le.a)({},t.properties.id,t.geometry.coordinates))}),{}),be=Object(ie.a)(de,(function(e){return{id:e.selected,region:je[e.selected]}})),pe=Object(ie.a)(de,(function(e){return e.filters})),he=Object(ie.a)((function(e){return e.router}),(function(e){return e.location})),ge=Object(ie.a)(he,(function(e){return e.pathname})),Oe=Object(ie.a)(he,(function(e){return e.search})),xe=Object(ie.a)(he,(function(e){return e.query})),me=function(e){return Object(ie.a)(xe,(function(t){return t[e]}))},fe=n(467),ve=n.n(fe);function ye(e){var t=Object(s.d)(),n=Object(v.e)().buildingId,r=ce(e.region),a=r.loading,c=r.data,i=function(e){var n;t((n=e.id,{type:$,payload:n}))};return a?Object(I.jsx)(ee.a,{circular:!0,className:ve.a.loadingIndicator,children:Object(I.jsx)(te.a,{active:!0,children:Object(I.jsx)(ne.a,{})})}):c.filter((function(e){return e.properties.results.length>0})).map((function(e){return Object(I.jsx)(T.b,{onClick:function(){return i(e)},paths:e.bounds.split(", ").map((function(e){var t=e.split(" "),n=Object(H.a)(t,2),r=n[0],a=n[1];return{lat:parseFloat(r),lng:parseFloat(a)}})),options:n&&n===e.id.toString()?{strokeColor:"green",fillColor:"green"}:{strokeColor:"black",fillColor:"black"}},e.id)}))}function _e(){var e=Object(s.e)(se);return e?Object(I.jsx)(ye,{region:e}):null}var we=c.a.memo(_e);function ke(){var e=Object(s.e)(be).region;return Object(I.jsx)(T.b,{paths:e.map((function(e){return e.map((function(e){var t=Object(H.a)(e,2);return{lng:t[0],lat:t[1]}}))})),options:{strokeColor:"black",fillColor:"black",fillOpacity:.2}})}var Ce={width:"100%",height:"100%"};function Se(e){var t=Y(),n=Object(a.useState)(null),r=Object(H.a)(n,2),c=r[0],i=r[1],o=Object(T.c)({googleMapsApiKey:"AIzaSyADke6h-GKt5dPB8IcjVeQ0lAaC1wL_LwY"}),l=o.isLoaded,u=o.loadError,d=Object(s.d)(),j=Object(a.useCallback)((function(){c&&d({type:Q,payload:c})}),[d,c]),b=Object(a.useCallback)((function(){return d(J(c))}),[d,c]);return u?Object(I.jsx)("div",{children:"Failed loading the map. Please try again later."}):l?function(){var e={zoomControlOptions:{position:window.google.maps.ControlPosition.RIGHT_TOP},rotateControl:!1,scaleControl:!1,streetViewControl:!1,panControl:!1,fullscreenControl:!1};return Object(I.jsxs)(T.a,{options:e,mapContainerStyle:Ce,center:t,zoom:t.zoom,onLoad:i,onProjectionChanged:b,onDragEnd:j,onZoomChanged:j,children:[t.zoom<=14&&t.zoom>=12&&Object(I.jsx)(ke,{}),t.zoom>=17&&Object(I.jsx)(we,{})]})}():Object(I.jsx)("div",{children:"Loading..."})}var Pe=c.a.memo(Se),Ie=n(468),Fe=n.n(Ie);var Le,Ne=function(){return Object(I.jsx)("div",{className:Fe.a.container,children:Object(I.jsx)(Pe,{})})},qe=n(131),Re=n.n(qe),Me=n(742),Ae=Object(l.gql)(Le||(Le=Object(re.a)(["\n  query UseActiveBuilding($id: Int!, $filter: PropertyFilter) {\n    building(id: $id) {\n      id\n      bounds\n      properties(filter: $filter) {\n        results {\n          category\n          type\n          rent_type\n          price\n          calc_price_per_sqm\n          rooms\n          area\n          floor\n          published_at\n        }\n      }\n    }\n  }\n"])));var Ee=n(66),Be=n(225),He=n(741),Te=n(753),De=n(277),ze=n.n(De);var Ge=n(58),Ye=n(278),We=n.n(Ye);function $e(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object(s.d)(),r=Object(s.e)(me(e)),a=Object(s.e)(xe);function c(r){n(Object(Ge.e)("?".concat(We.a.stringify(Object(u.a)(Object(u.a)(Object(u.a)({},a),t),{},Object(le.a)({},e,r)),{skipEmptyString:!0}))))}return[r,c]}var Ve=n(745),Qe=n(469);function Ue(e){if(e.error)return null;if(e.loading)return Object(I.jsx)(Re.a,{height:"100%",width:"100%"});var t=[{group:"Current building",value:e.priceCurrentBuilding||0},{group:"Active region",value:e.priceActiveRegion}];return Object(I.jsx)(Qe.a,{data:t,margin:{top:10,right:40,bottom:30,left:70},indexBy:"group",padding:.5,keys:["value"],isInteractive:!1,motionStiffness:300,motionDamping:40,axisLeft:{format:e.labelFormat},labelFormat:e.labelFormat})}function Ze(e){return 0===e.length?0:e.reduce((function(e,t){return e+t}),0)/e.length}function Ke(e){var t=Y().zoom,n={total:Math.min.apply(Math,Object(Ee.a)(e.prices.total)),sqm:Math.min.apply(Math,Object(Ee.a)(e.prices.sqm))},r={total:Math.round(Ze(e.prices.total)),sqm:Math.round(Ze(e.prices.sqm))},a={total:Math.round(Ze(e.regionPrices.data.total)),sqm:Math.round(Ze(e.regionPrices.data.sqm))},c={total:Math.max.apply(Math,Object(Ee.a)(e.prices.total)),sqm:Math.max.apply(Math,Object(Ee.a)(e.prices.sqm))};return Object(I.jsxs)(k.a,{textAlign:"center",children:[Object(I.jsxs)(k.a.Row,{columns:3,divided:!0,children:[Object(I.jsx)(k.a.Column,{children:Object(I.jsxs)(Ve.a,{size:"small",children:[Object(I.jsx)(Ve.a.Label,{children:"Min"}),Object(I.jsxs)(Ve.a.Value,{children:[n.total.toLocaleString(),Object(I.jsx)("small",{children:"\u20ac"})]}),Object(I.jsxs)(Ve.a.Label,{children:["(",n.sqm.toLocaleString()," ",Object(I.jsxs)("small",{children:["\u20ac/m",Object(I.jsx)("sup",{children:"2"})]}),")"]})]})}),Object(I.jsx)(k.a.Column,{children:Object(I.jsxs)(Ve.a,{size:"small",children:[Object(I.jsx)(Ve.a.Label,{children:"Average"}),Object(I.jsxs)(Ve.a.Value,{children:[r.total.toLocaleString(),Object(I.jsx)("small",{children:"\u20ac"})]}),Object(I.jsxs)(Ve.a.Label,{children:["(",r.sqm.toLocaleString()," ",Object(I.jsxs)("small",{children:["\u20ac/m",Object(I.jsx)("sup",{children:"2"})]}),")"]})]})}),Object(I.jsx)(k.a.Column,{children:Object(I.jsxs)(Ve.a,{size:"small",children:[Object(I.jsx)(Ve.a.Label,{children:"Max"}),Object(I.jsxs)(Ve.a.Value,{children:[c.total.toLocaleString(),Object(I.jsx)("small",{children:"\u20ac"})]}),Object(I.jsxs)(Ve.a.Label,{children:["(",c.sqm.toLocaleString()," ",Object(I.jsxs)("small",{children:["\u20ac/m",Object(I.jsx)("sup",{children:"2"})]}),")"]})]})})]}),t>=17?Object(I.jsxs)(I.Fragment,{children:[!e.regionPrices.error&&Object(I.jsx)("div",{children:Object(I.jsx)("h3",{children:"Average price comparison with active region"})}),Object(I.jsxs)(k.a.Row,{columns:2,divided:!0,children:[Object(I.jsx)(k.a.Column,{style:{height:200},children:Object(I.jsx)(Ue,{loading:e.regionPrices.loading,error:e.regionPrices.error,priceCurrentBuilding:r.total,priceActiveRegion:a.total,labelFormat:function(e){return"".concat(e>0?e.toLocaleString():"?"," \u20ac")}})}),Object(I.jsx)(k.a.Column,{style:{height:200},children:Object(I.jsx)(Ue,{loading:e.regionPrices.loading,error:e.regionPrices.error,priceCurrentBuilding:r.sqm,priceActiveRegion:a.sqm,labelFormat:function(e){return"".concat(e>0?e.toLocaleString():"?"," \u20ac/m2")}})})]})]}):null]})}var Je=n(481),Xe=n.n(Je),et={yearly:"/y",monthly:"/m",weekly:"/w",daily:"/d",hourly:"/h"},tt=[{Header:"Category",accessor:"category",filter:"equals"},{Header:"Type",accessor:"type",filter:"equals"},{accessor:"rent_type",filter:"equals"},{Header:"Total price",Cell:function(e){var t=e.row.original;return Object(I.jsxs)(I.Fragment,{children:[t.price.toLocaleString()," \u20ac","rent"===t.type&&et[t.rent_type]]})},accessor:"price"},{Header:"SQM Price",Cell:function(e){var t=e.value;return t?Object(I.jsxs)(I.Fragment,{children:[Math.round(t).toLocaleString()," \u20ac/m",Object(I.jsx)("sup",{children:"2"})]}):null},accessor:"calc_price_per_sqm"},{Header:"Area",Cell:function(e){var t=e.value;return t?Object(I.jsxs)(I.Fragment,{children:[t.toLocaleString()," m",Object(I.jsx)("sup",{children:"2"})]}):null},accessor:"area"},{Header:"Rooms",accessor:"rooms"},{Header:"Published at",Cell:function(e){var t=e.value;return t?ze()(t).format("YYYY-MM-DD HH:mm"):"Before 2018"},accessor:"published_at"}];function nt(e){return["category","type"].includes(e.column.id)?"left":"right"}function rt(e){var t=ce(Object(s.e)(se)),n=t.loading,r=t.error,a=t.data.reduce((function(e,t){var n=t.properties;return[].concat(Object(Ee.a)(e),Object(Ee.a)(n.results))}),[]).filter((function(t){return e.filter((function(e){return!!e.value})).reduce((function(e,n){var r=n.id,a=n.value;return e&&t[r]===a}),!0)}));return{loading:n,error:r,data:{total:a.reduce((function(e,t){var n=t.price;return[].concat(Object(Ee.a)(e),[n])}),[]),sqm:a.reduce((function(e,t){var n=t.calc_price_per_sqm;return[].concat(Object(Ee.a)(e),[n])}),[])}}}function at(e){var t=function(){var e=$e("category"),t=Object(H.a)(e,1)[0],n=$e("type"),r=Object(H.a)(n,1)[0],c=$e("rent_type"),i=Object(H.a)(c,1)[0];return Object(a.useMemo)((function(){return[{id:"category",value:t},{id:"type",value:r},{id:"rent_type",value:"rent"===r?i:void 0}]}),[t,r,i])}(),n=function(){var e=$e("page"),t=Object(H.a)(e,2),n=t[0],r=t[1];return[parseInt(n||1,10)-1,r]}(),r=Object(H.a)(n,2),c=r[0],i=r[1],o=Object(Be.useTable)({columns:tt,data:e.building.properties.results,initialState:{sortBy:[{id:"published_at",desc:!0}],pageSize:15,pageIndex:c,hiddenColumns:["rent_type"],filters:t},autoResetFilters:!1},Be.useFilters,Be.useSortBy,Be.usePagination),s=o.setFilter,l=o.headerGroups,d=o.rows,j=o.page,b=o.prepareRow,p=o.pageCount,h=o.gotoPage,g=rt(t);Object(a.useEffect)((function(){h(c)}),[h,c]),Object(a.useEffect)((function(){t.forEach((function(e){var t=e.id,n=e.value;return s(t,n)}))}),[t,s]);var O=Object(a.useMemo)((function(){return{total:d.map((function(e){return e.original.price})).filter((function(e){return e>0})),sqm:d.map((function(e){return e.original.calc_price_per_sqm})).filter((function(e){return e>0}))}}),[d]),x=j.length>0;return Object(I.jsxs)(I.Fragment,{children:[x&&Object(I.jsx)("div",{className:Xe.a.stats,children:Object(I.jsx)(Ke,{prices:O,regionPrices:g})}),Object(I.jsxs)(He.a,{singleLine:x,sortable:!0,children:[Object(I.jsx)(He.a.Header,{children:l.map((function(e){return Object(I.jsx)(He.a.Row,Object(u.a)(Object(u.a)({textAlign:"center"},e.getHeaderGroupProps()),{},{children:e.headers.map((function(e){return Object(I.jsx)(He.a.HeaderCell,Object(u.a)(Object(u.a)({},e.getHeaderProps(e.getSortByToggleProps())),{},{sorted:e.isSorted?e.isSortedDesc?"descending":"ascending":null,children:e.render("Header")}))}))}))}))}),Object(I.jsxs)(He.a.Body,{children:[j.map((function(e){return b(e),Object(I.jsx)(He.a.Row,Object(u.a)(Object(u.a)({},e.getRowProps()),{},{children:e.cells.map((function(e){return Object(I.jsx)(He.a.Cell,Object(u.a)(Object(u.a)({textAlign:nt(e)},e.getCellProps()),{},{children:e.render("Cell")}))}))}))})),!x&&Object(I.jsx)(He.a.Row,{children:Object(I.jsx)(He.a.Cell,{colSpan:tt.length,textAlign:"center",children:Object(I.jsxs)("p",{children:[Object(I.jsx)("strong",{children:"No classifieds could be found with the given filters."})," ","Clear the filters or open a different property to see data."]})})})]}),p>1&&Object(I.jsx)(He.a.Footer,{children:Object(I.jsx)(He.a.Row,{children:Object(I.jsx)(He.a.HeaderCell,{colSpan:tt.length,children:Object(I.jsx)(Te.a,{activePage:c+1,boundaryRange:1,onPageChange:function(e,t){return i(t.activePage)},size:"mini",siblingRange:2,totalPages:p})})})})]})]})}var ct=n(738),it=[{value:"apartment",text:"Apartment"},{value:"house",text:"House"},{value:"office",text:"Office"}],ot=[{value:"sell",text:"Sell"},{value:"rent",text:"Rent"},{value:"auction",text:"Auction"}],st=[{value:"yearly",text:"Yearly"},{value:"monthly",text:"Monthly"},{value:"weekly",text:"Weekly"},{value:"daily",text:"Daily"}],lt={page:void 0};function ut(){var e=$e("category",lt),t=Object(H.a)(e,2),n=t[0],r=t[1],a=$e("type",lt),c=Object(H.a)(a,2),i=c[0],o=c[1],s=$e("rent_type",lt),l=Object(H.a)(s,2),u=l[0],d=l[1];return Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(L.a.Item,{fitted:!0,children:Object(I.jsx)(ct.a,{placeholder:"Select category",clearable:!0,selection:!0,value:n,options:it,onChange:function(e,t){return r(t.value)}})}),Object(I.jsx)(L.a.Item,{fitted:!0,children:Object(I.jsx)(ct.a,{placeholder:"Select type",clearable:!0,selection:!0,value:i,options:ot,onChange:function(e,t){return o(t.value)}})}),"rent"===i&&Object(I.jsx)(L.a.Item,{fitted:!0,children:Object(I.jsx)(ct.a,{placeholder:"Select rent type",clearable:!0,selection:!0,fluid:!0,value:u,options:st,onChange:function(e,t){return d(t.value)}})})]})}function dt(e){var t=Object(s.d)(),n=Object(a.useCallback)((function(){return t({type:V})}),[t]);return Object(I.jsxs)(I.Fragment,{children:[Object(I.jsxs)(L.a,{secondary:!0,children:[Object(I.jsx)(L.a.Item,{fitted:!0,children:Object(I.jsx)(R.a,{content:"Return",icon:"left arrow",labelPosition:"left",onClick:n})}),Object(I.jsx)(ut,{})]}),Object(I.jsx)(Me.a,{info:!0,children:Object(I.jsx)("p",{children:"Data might be inaccurate. Some people provide wrong locations for their classifieds."})})]})}function jt(){var e=function(){var e=Object(v.e)().buildingId,t=Object(l.useQuery)(Ae,{variables:{id:Number(e),filter:{category:{in:["apartment","house","office"]},type:{in:["sell","rent","auction"]},price:{gt:1}}}}),n=t.data,r=t.error,a=t.loading;return{data:(null===n||void 0===n?void 0:n.building)||{},error:r,loading:a}}(),t=e.data,n=e.error;return e.loading?Object(I.jsxs)(ee.a,{basic:!0,children:[Object(I.jsx)(te.a,{inverted:!0,active:!0,children:Object(I.jsx)(ne.a,{content:"Loading the building data.."})}),Object(I.jsx)(Re.a,{count:20})]}):n?Object(I.jsx)(Me.a,{negative:!0,children:"An unexpected error occured when attempting to fetch the data. Try again later."}):t?Object(I.jsx)(at,{building:t}):Object(I.jsxs)(Me.a,{warning:!0,children:[Object(I.jsx)(Me.a.Header,{children:"Building not found"}),Object(I.jsx)("p",{children:"We could not locate a building here. Try again later."})]})}var bt=function(){return Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(dt,{}),Object(I.jsx)(jt,{})]})},pt=n(349),ht=n.n(pt),gt=n(482),Ot=n.n(gt);ht.a.start({releaseStage:"production",enabledReleaseStages:["production"],apiKey:"d834235e29f9f8aba796385d728e56f2",plugins:[new Ot.a],collectUserIp:!1});var xt=ht.a,mt=n(284),ft=n(751),vt=n(350),yt=n(351),_t=n.n(yt),wt=ue.riga.features.map((function(e){return{value:e.properties.id,text:e.properties.name}})),kt=[{value:"apartment",text:"Apartment"},{value:"house",text:"House"},{value:"land",text:"Land"}],Ct=[{value:"sell",text:"Sell"},{value:"rent",text:"Rent"}],St=[{value:"total",text:"Total price"},{value:"sqm",text:"Price/sqm"}];var Pt,It=function(){var e=Object(s.d)(),t=Object(s.e)(pe),n=t.category,r=t.type,a=t.price,c=Object(s.e)(be).id;return Object(I.jsx)("div",{className:_t.a.container,children:Object(I.jsxs)(L.a,{secondary:!0,children:[Object(I.jsx)(L.a.Item,{fitted:!0,children:Object(I.jsx)(ct.a,{placeholder:"Select location",search:function(e,t){var n=new RegExp(Object(vt.transliterate)(t).replace(/[^a-z\s-]/gi,""),"i");return e.filter((function(e){return n.test(Object(vt.transliterate)(e.text))}))},selection:!0,options:wt,value:c,onChange:function(t,n){return e((r=n.value,{type:Z,payload:r}));var r}})}),Object(I.jsx)(L.a.Item,{fitted:!0,className:_t.a.categoryDropdown,children:Object(I.jsx)(ct.a,{placeholder:"Select category",fluid:!0,selection:!0,value:n,options:kt,onChange:function(t,n){return e(X({category:n.value}))}})}),Object(I.jsx)(L.a.Item,{fitted:!0,children:Object(I.jsx)(ct.a,{placeholder:"Select type",fluid:!0,selection:!0,value:r,options:Ct,onChange:function(t,n){return e(X({type:n.value}))}})}),Object(I.jsx)(L.a.Item,{fitted:!0,children:Object(I.jsx)(ct.a,{placeholder:"Select price type",fluid:!0,selection:!0,value:a,options:St,onChange:function(t,n){return e(X({price:n.value}))}})})]})})},Ft=n(705),Lt=n(492),Nt=n(10),qt=n(483),Rt=n(353),Mt=n.n(Rt),At=function(e){var t,n="pending",r=e.then((function(e){n="success",t=e}),(function(e){n="error",t=e}));return{read:function(){switch(n){case"pending":throw r;case"error":throw t;default:return t}}}};function Et(){var e=l.useQuery.apply(void 0,arguments);return e.loading&&At(new Promise((function(t){return!e.loading&&t()}))).read(),e}var Bt=Object(l.gql)(Pt||(Pt=Object(re.a)(['\n  query($filters: String!) {\n    response(filters: $filters)\n      @rest(\n        type: "PriceResults"\n        method: "GET"\n        path: "/stats/monthly?discard=0.1&filters={args.filters}"\n      ) {\n      loadingResults\n      results {\n        count\n        start_datetime\n        end_datetime\n        price {\n          min\n          max\n          median\n          mean\n          mode\n        }\n        pricePerSqm {\n          min\n          max\n          median\n          mean\n          mode\n        }\n      }\n    }\n  }\n'])));function Ht(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(a.useState)(0),n=Object(H.a)(t,2),r=n[0],c=n[1],i=Object(s.e)(pe),o=i.category,l=i.type,d=Object(s.e)(be),j=d.id,b=Object(u.a)({category:o,type:l,location_classificator:j},e),p=encodeURIComponent(JSON.stringify(b)),h=Et(Bt,{variables:{filters:p},pollInterval:r}),g=h.data,O=(null===g||void 0===g?void 0:g.response)||{},x=O.loadingResults;return Object(a.useEffect)((function(){c((function(){return 0===x?0:x<=2?1e3:3e3}))}),[x]),g.response}function Tt(){var e=Object(s.e)(pe).price,t=Ht().results,n=Object(a.useMemo)((function(){return[{id:"Average Price",data:t.map((function(t){var n="sqm"===e?t.pricePerSqm:t.price;return Object(u.a)(Object(u.a)({},n),{},{x:t.start_datetime.substr(0,10),y:n.mean})}))}]}),[t,e]),r=n[0].data.reduce((function(e,t){var n=t.max;return n>e?n:e}),0);function c(t){var n=t.value;return Object(I.jsxs)("span",{children:[Number(n).toLocaleString("en",{minimumFractionDigits:2})," ","sqm"===e?Object(I.jsxs)("span",{children:["\u20ac/m",Object(I.jsx)("sup",{children:"2"})]}):"\u20ac"]})}return Object(I.jsx)(qt.a,{data:n,margin:{top:10,right:10,bottom:100,left:50},xScale:{type:"time",format:"%Y-%m-%d",precision:"month"},xFormat:"time:%Y-%m-%d",yScale:{type:"linear",stacked:!1,max:1.05*r},sliceTooltip:function(e){var t=e.slice;return Object(I.jsx)("div",{className:Mt.a.tooltip,children:t.points.map((function(e){return Object(I.jsxs)("div",{children:[Object(I.jsx)("div",{children:Object(I.jsx)("strong",{children:ze()(e.data.x).format("YYYY-MM-DD")})}),Object(I.jsxs)("div",{children:[Object(I.jsx)("strong",{children:"Min:"})," ",Object(I.jsx)(c,{value:e.data.min})]}),Object(I.jsxs)("div",{children:[Object(I.jsxs)("strong",{children:[e.serieId,":"]})," ",Object(I.jsx)(c,{value:e.data.yFormatted})]}),Object(I.jsxs)("div",{children:[Object(I.jsx)("strong",{children:"Max:"})," ",Object(I.jsx)(c,{value:e.data.max})]}),Object(I.jsx)("hr",{}),Object(I.jsxs)("div",{children:[Object(I.jsx)("strong",{children:"Mode:"})," ",Object(I.jsx)(c,{value:e.data.mode})]}),Object(I.jsxs)("div",{children:[Object(I.jsx)("strong",{children:"Median:"})," ",Object(I.jsx)(c,{value:e.data.median})]})]},e.id)}))})},axisBottom:{format:"%Y-%m",tickValues:"every 2 months",tickRotation:-90},axisLeft:{format:function(e){return"".concat(e," \u20ac")}},enablePoints:!0,curve:"monotoneX",useMesh:!0,enableSlices:"x",layers:["grid","markers","axes","areas","crosshair",Dt,"lines","points","slices","mesh","legends"]})}function Dt(e){var t=e.series,n=e.xScale,r=e.yScale,a=(e.innerHeight,Object(Ft.a)().x((function(e){return n(e.data.x)})).y0((function(e){return r(e.data.min)})).y1((function(e){return r(e.data.max)})).curve(Lt.a));return Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(Nt.b,{defs:[{id:"pattern",type:"patternLines",background:"transparent",color:"#3daff7",lineWidth:1,spacing:6,rotation:-45}]}),Object(I.jsx)("path",{d:a(t[0].data),fill:"url(#pattern)",fillOpacity:.2,stroke:"#3daff7",strokeWidth:.4})]})}var zt=function(){return Object(I.jsx)(ee.a,{basic:!0,className:Mt.a.container,children:Object(I.jsx)(mt.ErrorBoundary,{fallback:Object(I.jsx)(Me.a,{negative:!0,children:"Failed loading chart data. Please try again later."}),onError:xt.notify,children:Object(I.jsx)(c.a.Suspense,{fallback:Object(I.jsx)(te.a,{inverted:!0,active:!0,children:Object(I.jsx)(ne.a,{})}),children:Object(I.jsx)(Tt,{})})})})};var Gt=n(202),Yt=n.n(Gt);function Wt(){return Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("p",{children:"MoM: month-over-month"}),Object(I.jsx)("p",{children:"YoY: year-over-year"})]})}function $t(){var e=Object(s.e)(pe).price,t=function(){var e=Object(s.e)(pe).price,t=Ht(),n=t.loadingResults,r=t.results;if(n>0)return{change:{}};var a="sqm"===e?"pricePerSqm":"price",c=r[r.length-1][a].mean;return{price:c,change:{mom:100*(1-c/r[r.length-2][a].mean),yoy:100*(1-c/r[r.length-13][a].mean)}}}(),n=t.price,r=t.change.mom,a=t.change.yoy;return Object(I.jsxs)(I.Fragment,{children:[Object(I.jsxs)(Ve.a.Value,{children:[Object(I.jsxs)("div",{className:Yt.a.statisticAddon,children:[isFinite(r)&&Object(I.jsxs)("div",{children:[Object(I.jsxs)("span",{className:r<0?Yt.a.textGreen:Yt.a.textRed,children:[r<0?"+":"",-r.toFixed(2),"%"]})," ","MoM"]}),isFinite(a)&&Object(I.jsxs)("div",{children:[Object(I.jsxs)("span",{className:a<0?Yt.a.textGreen:Yt.a.textRed,children:[a<0?"+":"",-a.toFixed(2),"%"]})," ","YoY"]})]}),n?parseInt(n,10).toLocaleString("en"):"?"]}),Object(I.jsxs)(Ve.a.Label,{children:["Average Price (\u20ac","sqm"===e?Object(I.jsxs)("span",{children:["/m",Object(I.jsx)("sup",{children:"2"})]}):"",")"," ",Object(I.jsx)(N.a,{content:Object(I.jsx)(Wt,{}),trigger:Object(I.jsx)(q.a,{name:"help circle"})})]})]})}var Vt=function(){return Object(I.jsx)(Ve.a,{children:Object(I.jsx)(c.a.Suspense,{fallback:Object(I.jsx)(Re.a,{height:60,width:240}),children:Object(I.jsx)($t,{})})})};function Qt(){var e=function(){var e=Object(s.e)(pe).price,t=Ht({type:"rent"}).results,n=Ht({type:"sell"}).results;if(!t.length||!n.length)return 0;var r="sqm"===e?"pricePerSqm":"price",a=t[t.length-1][r].mean,c=n[n.length-1][r].mean;return a&&c?a/c*100:0}(),t=e?"".concat(e.toFixed(2),"%"):"?";return Object(I.jsx)(Ve.a.Value,{children:t})}function Ut(){return Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("p",{children:"How much of the invested capital can I expect to make back each year?"}),Object(I.jsx)("p",{children:"A bigger number is better for landlords; a smaller - for renters."}),Object(I.jsx)("p",{children:"Calculation: average rent price / sell price in the last month"})]})}var Zt=function(){return Object(I.jsxs)(Ve.a,{children:[Object(I.jsx)(c.a.Suspense,{fallback:Object(I.jsx)(Re.a,{height:42}),children:Object(I.jsx)(Qt,{})}),Object(I.jsxs)(Ve.a.Label,{children:["Rental Yield"," ",Object(I.jsx)(N.a,{content:Object(I.jsx)(Ut,{}),trigger:Object(I.jsx)(q.a,{name:"help circle"})})]})]})},Kt=n(354),Jt=n.n(Kt);var Xt=function(){var e=Object(s.e)(be).id,t=ue.riga.features.find((function(t){return t.properties.id===e})).properties.name;return Object(I.jsx)(I.Fragment,{children:Object(I.jsxs)("div",{className:Jt.a.content,children:[Object(I.jsxs)(ft.a,{as:"h2",children:["Average Prices in"," ",Object(I.jsx)("span",{className:Jt.a.highlightedText,children:t})]}),Object(I.jsx)(It,{}),Object(I.jsx)(zt,{}),Object(I.jsx)(k.a,{children:Object(I.jsxs)(k.a.Row,{children:[Object(I.jsxs)(k.a.Column,{tablet:16,computer:16,largeScreen:10,widescreen:7,children:[Object(I.jsx)(ft.a,{as:"h3",children:"Last Month"}),Object(I.jsx)(mt.ErrorBoundary,{fallback:Object(I.jsx)(Me.a,{negative:!0,children:"Failed loading the data. Please try again later."}),onError:xt.notify,children:Object(I.jsxs)(Ve.a.Group,{size:"small",children:[Object(I.jsx)(Vt,{}),Object(I.jsx)(Zt,{})]})})]}),Object(I.jsx)(k.a.Column,{tablet:16,computer:16,largeScreen:6,widescreen:9,verticalAlign:"bottom",stretched:!0,children:Object(I.jsx)(Me.a,{info:!0,icon:"info",header:"Interested in a specific building?",content:"Zoom in on the map and click on a building. This will show data about your selected property."})})]})})]})})},en=n(203),tn=n.n(en);var nn=function(e){return Object(I.jsxs)(I.Fragment,{children:[Object(I.jsxs)(w.a,{fluid:!0,className:tn.a.container,children:[Object(I.jsx)(_.a,{className:tn.a.githubCorner,href:"https://github.com/brokalys/map-app",direction:"left"}),Object(I.jsx)(v.c,{children:Object(I.jsx)(v.a,{path:["/:lat,:lng,:zoom/building/:buildingId(\\d+)","/:lat,:lng,:zoom","/"],children:Object(I.jsxs)(k.a,{className:tn.a.grid,children:[Object(I.jsxs)(k.a.Column,{computer:9,className:tn.a.leftPanel,children:[Object(I.jsx)(B,{}),Object(I.jsxs)(v.c,{children:[Object(I.jsx)(v.a,{path:"/:lat,:lng,:zoom/building/:buildingId(\\d+)",children:Object(I.jsx)(bt,{})}),Object(I.jsx)(v.a,{path:"*",children:Object(I.jsx)(Xt,{})})]})]}),Object(I.jsx)(k.a.Column,{computer:7,className:tn.a.rightPanel,children:Object(I.jsx)(Ne,{})})]})})})]}),Object(I.jsx)(F,{})]})},rn=n(449),an=n(105),cn=n(97),on=n(484),sn=n(486),ln={bounds:{}};function un(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ln,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case U:var n=t.payload,r={nw:{lat:n.getBounds().getSouthWest().lat(),lng:n.getBounds().getNorthEast().lng()},ne:{lat:n.getBounds().getNorthEast().lat(),lng:n.getBounds().getNorthEast().lng()},sw:{lat:n.getBounds().getSouthWest().lat(),lng:n.getBounds().getSouthWest().lng()},se:{lat:n.getBounds().getNorthEast().lat(),lng:n.getBounds().getSouthWest().lng()}};return Object(u.a)(Object(u.a)({},e),{},{bounds:r});default:return e}}var dn={selected:"latvia-riga-vecpilseta",filters:{category:"apartment",type:"sell",price:"sqm"}};function jn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Z:return Object(u.a)(Object(u.a)({},e),{},{selected:t.payload});case K:return Object(u.a)(Object(u.a)({},e),{},{filters:Object(u.a)(Object(u.a)({},e.filters),t.payload)});default:return e}}var bn=function(e){return Object(cn.combineReducers)({router:Object(r.b)(e),map:un,neighborhood:jn})},pn=n(16),hn=n.n(pn),gn=n(39),On=hn.a.mark(mn),xn=hn.a.mark(fn);function mn(){var e,t;return hn.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(gn.c)(ge);case 2:return e=n.sent,t=e.split("/"),n.next=6,Object(gn.b)(Object(Ge.d)("/".concat(t[1])));case 6:case"end":return n.stop()}}),On)}function fn(){return hn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(gn.e)(V,mn);case 2:case"end":return e.stop()}}),xn)}var vn=fn,yn=hn.a.mark(kn),_n=hn.a.mark(Cn);function wn(e){var t=e.reduce((function(t,n){return[t[0]+n[0]/e.length,t[1]+n[1]/e.length]}),[0,0]);return{lat:t[1],lng:t[0]}}function kn(e){var t,n,r,a,c;return hn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(gn.c)(be);case 2:return t=e.sent,n=t.region,r=wn(n[0]),a=r.lat,c=r.lng,e.next=7,Object(gn.b)(Object(Ge.e)("/".concat(a,",").concat(c,",13")));case 7:case"end":return e.stop()}}),yn)}function Cn(){return hn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(gn.d)(Z,kn);case 2:case"end":return e.stop()}}),_n)}var Sn=Cn,Pn=hn.a.mark(Fn),In=hn.a.mark(Ln);function Fn(e){var t,n,r,a,c,i;return hn.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.payload,o.next=3,Object(gn.c)(ge);case 3:return n=o.sent,r=n.split("/"),a="/".concat(r[1],"/building/").concat(t),"building"===r[2]&&r[3]===String(t)&&(a="/".concat(r[1])),o.next=9,Object(gn.c)(xe);case 9:return c=o.sent,i=We.a.stringify(Object(u.a)(Object(u.a)({},c),{},{page:void 0}),{skipEmptyString:!0}),o.next=13,Object(gn.b)(Object(Ge.d)("".concat(a,"?").concat(i)));case 13:case"end":return o.stop()}}),Pn)}function Ln(){return hn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(gn.e)($,Fn);case 2:case"end":return e.stop()}}),In)}var Nn=Ln,qn=hn.a.mark(Mn),Rn=hn.a.mark(An);function Mn(e){var t,n,r,a,c,i;return hn.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.payload,n=t.getZoom(),o.next=4,Object(gn.c)(ge);case 4:return r=o.sent,o.next=7,Object(gn.c)(Oe);case 7:if(a=o.sent,c=r.split("/"),i="/".concat(t.center.lat(),",").concat(t.center.lng(),",").concat(n),"building"===c[2]&&n>14&&(i+="/building/".concat(c[3])),i!==r){o.next=13;break}return o.abrupt("return");case 13:return o.next=15,Object(gn.b)(Object(Ge.e)(i+a));case 15:case"end":return o.stop()}}),qn)}function An(){return hn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(gn.e)(Q,Mn);case 2:case"end":return e.stop()}}),Rn)}var En=An,Bn=hn.a.mark(Tn),Hn=hn.a.mark(Dn);function Tn(e){var t;return hn.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.payload,n.next=3,Object(gn.b)(J(t));case 3:case"end":return n.stop()}}),Bn)}function Dn(){return hn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(gn.e)(Q,Tn);case 2:case"end":return e.stop()}}),Hn)}var zn=Dn,Gn=hn.a.mark(Yn);function Yn(){return hn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(gn.a)([vn(),Sn(),Nn(),En(),zn()]);case 2:case"end":return e.stop()}}),Gn)}var Wn=Object(an.a)({hashType:"slash"}),$n=Object(sn.a)(),Vn=Object(cn.createStore)(bn(Wn),Object(on.composeWithDevTools)(Object(cn.applyMiddleware)(Object(rn.a)(Wn),$n)));$n.run(Yn);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(677),n(678);var Qn=xt.getPlugin("react").createErrorBoundary(c.a);o.a.render(Object(I.jsx)(Qn,{children:Object(I.jsx)(s.a,{store:Vn,children:Object(I.jsx)(r.a,{history:Wn,children:Object(I.jsx)(l.ApolloProvider,{client:f,children:Object(I.jsx)(nn,{})})})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[679,1,2]]]);
//# sourceMappingURL=main.bc7b5d48.chunk.js.map